<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a1a1a">
    <title>‚öΩ FootScore Pro - ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        /* ========== CSS Variables ========== */
        :root {
            --primary: #00c853;
            --primary-dark: #009624;
            --primary-light: #5efc82;
            --secondary: #00b0ff;
            --danger: #ff5252;
            --warning: #ffc107;
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
            --gray: #94a3b8;
            --border: #1e293b;
            --card-bg: #1a1d2e;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --skeleton: linear-gradient(90deg, var(--border) 25%, #2a3347 50%, var(--border) 75%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--dark);
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        /* ========== Header & Navigation ========== */
        .header {
            background: var(--darker);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.5);
            border-bottom: 2px solid var(--primary);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .live-indicator {
            background: var(--danger);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 6px;
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* ========== Connection Status ========== */
        .connection-status {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 2000;
            background: var(--darker);
            border: 2px solid var(--danger);
            border-radius: 20px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--light);
            box-shadow: var(--shadow);
            transform: translateX(-120%);
            transition: transform 0.3s ease;
        }

        .connection-status.show {
            transform: translateX(0);
        }

        .connection-status.online {
            border-color: var(--primary);
            background: var(--primary-dark);
        }

        /* ========== Stats Bar ========== */
        .stats-bar {
            background: linear-gradient(90deg, var(--darker), var(--card-bg));
            padding: 10px 15px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            border-bottom: 1px solid var(--border);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 2px;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
        }

        /* ========== Time Filter ========== */
        .time-filter {
            position: sticky;
            top: 84px;
            z-index: 900;
            background: var(--darker);
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
        }

        .time-buttons {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding-bottom: 5px;
        }

        .time-btn {
            flex: 0 0 auto;
            padding: 8px 16px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--gray);
            font-family: 'Cairo', sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
        }

        .time-btn.active {
            background: var(--primary);
            color: var(--darker);
            border-color: var(--primary);
        }

        /* ========== Skeleton Loading ========== */
        .skeleton-container {
            padding: 15px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        @media (min-width: 768px) {
            .skeleton-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .skeleton-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .skeleton-card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid var(--border);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: 200px 0; }
        }

        .skeleton-header {
            padding: 15px;
            background: var(--border);
            display: flex;
            justify-content: space-between;
        }

        .skeleton-circle {
            width: 30px;
            height: 30px;
            background: var(--skeleton);
            background-size: 200px 100%;
            border-radius: 50%;
        }

        .skeleton-text {
            height: 20px;
            background: var(--skeleton);
            background-size: 200px 100%;
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .skeleton-text.small {
            width: 60px;
        }

        .skeleton-text.medium {
            width: 100px;
        }

        .skeleton-text.large {
            width: 150px;
        }

        .skeleton-body {
            padding: 20px 15px;
        }

        .skeleton-team {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .skeleton-logo {
            width: 60px;
            height: 60px;
            background: var(--skeleton);
            background-size: 200px 100%;
            border-radius: 50%;
        }

        /* ========== Matches Grid ========== */
        .matches-grid {
            padding: 15px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            max-width: 1400px;
            margin: 0 auto;
        }

        @media (min-width: 768px) {
            .matches-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .matches-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .match-card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            transition: var(--transition);
            position: relative;
            border: 1px solid var(--border);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .match-card.live {
            border-color: var(--danger);
        }

        .match-card.upcoming {
            border-color: var(--secondary);
        }

        .match-card.finished {
            border-color: var(--gray);
        }

        .match-card.important {
            border-color: var(--warning);
            box-shadow: 0 0 20px rgba(255, 193, 7, 0.2);
        }

        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        .match-header {
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .league-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .league-logo {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .match-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .status-live {
            background: var(--danger);
            color: white;
            animation: pulse 2s infinite;
        }

        .status-upcoming {
            background: var(--secondary);
            color: var(--darker);
        }

        .status-finished {
            background: var(--gray);
            color: var(--darker);
        }

        /* ========== Teams Section ========== */
        .teams-section {
            padding: 20px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: center;
        }

        .team {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .team-logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-light), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--darker);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .team-name {
            font-weight: 700;
            font-size: 1.1rem;
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .vs-section {
            padding: 0 20px;
            text-align: center;
            min-width: 120px;
        }

        .score {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .vs {
            font-size: 0.9rem;
            color: var(--gray);
            font-weight: 600;
        }

        /* ========== Match Details ========== */
        .match-details {
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-top: 1px solid var(--border);
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--gray);
        }

        .detail-item i {
            color: var(--primary);
            width: 16px;
        }

        /* ========== FAB Buttons ========== */
        .fab-container {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: var(--darker);
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 200, 83, 0.4);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fab:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 8px 25px rgba(0, 200, 83, 0.6);
        }

        /* ========== Error States ========== */
        .error-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
            display: none;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
            display: none;
        }

        /* ========== Notifications ========== */
        .notification {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            background: var(--primary);
            color: var(--darker);
            padding: 15px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            z-index: 3000;
            animation: slideDown 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        @keyframes slideDown {
            from { transform: translateY(-100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* ========== League Filter ========== */
        .league-filter {
            padding: 15px;
            background: var(--darker);
            border-bottom: 1px solid var(--border);
        }

        .league-buttons {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            padding-bottom: 5px;
        }

        .league-btn {
            flex: 0 0 auto;
            padding: 8px 16px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--gray);
            font-family: 'Cairo', sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
        }

        .league-btn.active {
            background: var(--primary);
            color: var(--darker);
            border-color: var(--primary);
        }

        /* ========== Responsive ========== */
        @media (max-width: 480px) {
            .header-content {
                flex-direction: column;
                gap: 10px;
            }
            
            .stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .team-logo {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .score {
                font-size: 2rem;
            }
            
            .matches-grid {
                padding: 10px;
            }
            
            .match-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Connection Status -->
    <div id="connectionStatus" class="connection-status">
        <i class="fas fa-wifi"></i>
        <span>ÿ¨ÿßÿ±Ÿä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜÿ©</span>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-futbol"></i>
                </div>
                <div>
                    <h1 style="font-size: 1.5rem; margin-bottom: 2px;">FootScore Pro</h1>
                    <div style="font-size: 0.8rem; color: var(--gray);">ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©</div>
                </div>
            </div>
            <div class="live-indicator">
                <i class="fas fa-circle" style="font-size: 0.6rem;"></i>
                <span id="liveMatchesCount">0</span> ŸÖÿ®ÿßÿ¥ÿ±
            </div>
        </div>
    </header>

    <!-- Stats Bar -->
    <div class="stats-bar">
        <div class="stat-item">
            <div class="stat-value" id="totalMatches">0</div>
            <div class="stat-label">ŸÖÿ®ÿßÿ±ÿßÿ©</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="liveMatches">0</div>
            <div class="stat-label">ŸÖÿ®ÿßÿ¥ÿ±</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="leaguesCount">0</div>
            <div class="stat-label">ÿØŸàÿ±Ÿä</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="updateTime">ÿßŸÑÿ¢ŸÜ</div>
            <div class="stat-label">ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´</div>
        </div>
    </div>

    <!-- Time Filter -->
    <div class="time-filter">
        <div class="time-buttons" id="timeFilter">
            <!-- ÿ≥Ÿäÿ™ŸÖ ÿ™ÿπÿ®ÿ¶ÿ™Ÿáÿß ÿØŸäŸÜÿßŸÖŸäŸÉŸäŸãÿß -->
        </div>
    </div>

    <!-- League Filter -->
    <div class="league-filter">
        <div class="league-buttons" id="leagueFilter">
            <!-- ÿ≥Ÿäÿ™ŸÖ ÿ™ÿπÿ®ÿ¶ÿ™Ÿáÿß ÿØŸäŸÜÿßŸÖŸäŸÉŸäŸãÿß -->
        </div>
    </div>

    <!-- Skeleton Loading -->
    <div class="skeleton-container" id="skeletonLoading">
        <div class="skeleton-card">
            <div class="skeleton-header">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div class="skeleton-circle"></div>
                    <div style="flex: 1;">
                        <div class="skeleton-text medium"></div>
                        <div class="skeleton-text small"></div>
                    </div>
                </div>
                <div class="skeleton-text small"></div>
            </div>
            <div class="skeleton-body">
                <div class="skeleton-team">
                    <div class="skeleton-logo"></div>
                    <div style="flex: 1;">
                        <div class="skeleton-text large"></div>
                    </div>
                </div>
                <div style="text-align: center; margin: 20px 0;">
                    <div class="skeleton-text medium" style="margin: 0 auto 10px;"></div>
                    <div class="skeleton-text small" style="margin: 0 auto;"></div>
                </div>
                <div class="skeleton-team">
                    <div style="flex: 1;">
                        <div class="skeleton-text large"></div>
                    </div>
                    <div class="skeleton-logo"></div>
                </div>
            </div>
        </div>
        <!-- ÿ™ŸÉÿ±ÿßÿ± ÿßŸÑŸáŸäŸÉŸÑ ÿßŸÑÿπÿ∏ŸÖŸä -->
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
    </div>

    <!-- Matches Grid -->
    <div class="matches-grid" id="matchesContainer" style="display: none;">
        <!-- ÿ≥Ÿäÿ™ŸÖ ÿ™ÿπÿ®ÿ¶ÿ™Ÿáÿß ÿØŸäŸÜÿßŸÖŸäŸÉŸäŸãÿß -->
    </div>

    <!-- Empty State -->
    <div class="empty-state" id="emptyState">
        <i class="fas fa-futbol" style="font-size: 3rem; margin-bottom: 15px; color: var(--gray);"></i>
        <h3 style="margin-bottom: 10px;">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑŸàŸÇÿ™</h3>
        <p style="color: var(--gray); margin-bottom: 20px;">ÿ™ÿ∏Ÿáÿ± ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØÿ© ÿ™ŸÑŸÇÿßÿ¶ŸäŸãÿß</p>
        <button class="fab" onclick="FootballApp.refreshMatches()" style="margin: 0 auto; width: 50px; height: 50px;">
            <i class="fas fa-sync-alt"></i>
        </button>
    </div>

    <!-- Error State -->
    <div class="error-state" id="errorState">
        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 15px; color: var(--danger);"></i>
        <h3 style="margin-bottom: 10px;">ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ</h3>
        <p style="color: var(--gray); margin-bottom: 20px;">ÿ¨ÿßÿ±Ÿä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜÿ©</p>
        <button class="fab" onclick="FootballApp.refreshMatches()" style="margin: 0 auto; width: 50px; height: 50px;">
            <i class="fas fa-redo"></i>
        </button>
    </div>

    <!-- FAB Buttons -->
    <div class="fab-container">
        <button class="fab" onclick="FootballApp.refreshMatches()" title="ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™">
            <i class="fas fa-sync-alt"></i>
        </button>
        <button class="fab" onclick="FootballApp.showLiveMatches()" title="ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©">
            <i class="fas fa-tv"></i>
        </button>
        <button class="fab" onclick="FootballApp.scrollToTop()" title="ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿ£ÿπŸÑŸâ">
            <i class="fas fa-arrow-up"></i>
        </button>
    </div>

    <script>
        // =============================================
        // FootballApp - Ultimate Version
        // ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑŸÜŸáÿßÿ¶Ÿä ŸÖÿπ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿµŸÑÿßÿ≠ÿßÿ™ ŸàÿßŸÑÿ£ŸÖÿßŸÜ
        // =============================================

        class FootballApp {
            constructor() {
                this.config = {
                    // üîí ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÄ Proxy - ÿßÿÆÿ™ÿ± ÿ£ÿ≠ÿØ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™:
                    PROXY_URL: 'https://football-proxy-production.up.railway.app/api', // ŸÖÿ´ÿßŸÑ ŸÑŸÄ Railway
                    // ÿ£Ÿà: 'https://your-worker.workers.dev/api' ŸÑŸÄ Cloudflare Worker
                    // ÿ£Ÿà: 'https://your-proxy.onrender.com/api' ŸÑŸÄ Render
                    
                    // ‚ö†Ô∏è ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿÆŸäÿßÿ± 2 ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸÑÿØŸäŸÉ proxy:
                    USE_DIRECT_API: false, // ÿ∂ÿπ true ŸÑŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ± (ÿ∫Ÿäÿ± ÿ¢ŸÖŸÜ)
                    DIRECT_API_KEY: '', // ÿßÿ™ÿ±ŸÉŸá ŸÅÿßÿ±ÿ∫Ÿãÿß ŸÑŸÑÿ≠ŸÖÿßŸäÿ©
                    
                    // üïí ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ
                    API_TIMEOUT: 7000,
                    UPDATE_INTERVAL: 30000,
                    MAX_LOADING_TIME: 5000,
                    CACHE_DURATION: 15 * 60 * 1000,
                    OFFLINE_UPDATE_INTERVAL: 60000,
                    
                    VERSION: '6.1.0'
                };

                this.state = {
                    // ÿ≠ÿßŸÑÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ
                    isOnline: navigator.onLine,
                    isLoading: false,
                    isForced: false,
                    isEmergencyData: false,
                    
                    // ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ÿÆÿ∑ÿßÿ°
                    apiErrorCount: 0,
                    maxApiErrors: 3,
                    proxyErrorCount: 0,
                    maxProxyErrors: 3,
                    
                    // ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                    matches: [],
                    filteredMatches: [],
                    leagues: new Set(),
                    countries: new Set(),
                    
                    // ÿßŸÑŸÅŸÑÿßÿ™ÿ±
                    timeFilter: 'today',
                    leagueFilter: 'all',
                    
                    // ÿßŸÑÿ™ÿ™ÿ®ÿπ
                    lastUpdate: null,
                    updateCount: 0,
                    dataSource: 'unknown', // 'proxy', 'direct', 'cache', 'emergency'
                    
                    // ÿßŸÑŸÖŸàŸÇÿ™ÿßÿ™
                    loadingTimeout: null,
                    updateTimer: null,
                    forceTimer: null,
                    apiController: null
                };

                // ÿ™ŸáŸäÿ¶ÿ© ŸÅŸàÿ±Ÿäÿ©
                this.initialize();
            }

            async initialize() {
                console.log('üöÄ ÿ®ÿØÿ° FootScore Pro - ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑŸÜŸáÿßÿ¶Ÿä...');
                
                // 1. ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸàÿßÿ¨Ÿáÿ© ŸÅŸàÿ±Ÿãÿß
                this.showUI();
                
                // 2. ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿπŸäŸÜ ŸÑŸÑÿ£ÿ≠ÿØÿßÿ´
                this.setupEventListeners();
                
                // 3. ÿ®ÿØÿ° ÿßŸÑÿπÿØ ÿßŸÑÿ™ŸÜÿßÿ≤ŸÑŸä ÿßŸÑŸÇÿ≥ÿ±Ÿä
                this.startForceTimer();
                
                // 4. ŸÖÿ≠ÿßŸàŸÑÿ© ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                this.fetchDataWithFallback();
                
                // 5. ÿ®ÿØÿ° ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ÿßÿ™ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿäÿ©
                this.startAutoUpdates();
            }

            // ========== FAIL-SAFE SYSTEM ==========
            showUI() {
                // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸàÿßÿ¨Ÿáÿ© ŸÅŸä 500ms
                setTimeout(() => {
                    document.getElementById('skeletonLoading').style.display = 'none';
                    document.getElementById('matchesContainer').style.display = 'grid';
                }, 500);
            }

            startForceTimer() {
                this.state.forceTimer = setTimeout(() => {
                    console.log('‚ö° ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿ¨ÿ®ÿßÿ±Ÿä ÿ®ÿπÿØ 5 ÿ´ŸàÿßŸÜŸä...');
                    this.state.isForced = true;
                    this.forceLoad();
                }, this.config.MAX_LOADING_TIME);
            }

            forceLoad() {
                clearTimeout(this.state.forceTimer);
                clearTimeout(this.state.loadingTimeout);
                
                if (this.state.matches.length === 0) {
                    this.loadEmergencyData();
                }
                
                this.hideLoading();
                this.hideError();
            }

            // ========== DATA FETCHING - MULTI-LAYER ==========
            async fetchDataWithFallback() {
                this.state.isLoading = true;
                
                try {
                    // ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© 1: ÿßŸÑŸÄ Proxy (ÿ¢ŸÖŸÜ)
                    if (!this.config.USE_DIRECT_API) {
                        try {
                            const proxyData = await this.fetchFromProxy();
                            if (proxyData && proxyData.length > 0) {
                                await this.processData(proxyData, 'proxy');
                                return;
                            }
                        } catch (proxyError) {
                            console.warn('‚ö†Ô∏è ŸÅÿ¥ŸÑ ÿßŸÑŸÄ Proxy:', proxyError.message);
                        }
                    }
                    
                    // ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© 2: API ÿßŸÑŸÖÿ®ÿßÿ¥ÿ± (ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ŸÖŸèŸÜÿ¥ÿ∑)
                    if (this.config.USE_DIRECT_API && this.state.isOnline) {
                        try {
                            const apiData = await this.fetchDirectAPI();
                            if (apiData && apiData.length > 0) {
                                await this.processData(apiData, 'direct');
                                return;
                            }
                        } catch (apiError) {
                            console.warn('‚ö†Ô∏è ŸÅÿ¥ŸÑ API ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±:', apiError.message);
                        }
                    }
                    
                    // ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© 3: ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜÿ©
                    const cachedData = this.loadCachedData();
                    if (cachedData && cachedData.length > 0) {
                        await this.processData(cachedData, 'cache');
                        this.showConnectionStatus('ÿ¨ÿßÿ±Ÿä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜÿ©', 'info');
                        return;
                    }
                    
                    // ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© 4: ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ÿßÿ±ÿ¶ÿ©
                    throw new Error('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ™ÿßÿ≠ÿ©');
                    
                } catch (error) {
                    console.warn('‚ö†Ô∏è ÿ¨ŸÖŸäÿπ ŸÖÿ≠ÿßŸàŸÑÿßÿ™ ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅÿ¥ŸÑÿ™:', error);
                    this.loadEmergencyData();
                    
                } finally {
                    this.state.isLoading = false;
                    this.hideLoading();
                    clearTimeout(this.state.forceTimer);
                }
            }

            // ========== PROXY FETCH (ÿßŸÑÿ£ŸÖÿßŸÜ ÿßŸÑÿ£ŸàŸÑ) ==========
            async fetchFromProxy() {
                if (!this.state.isOnline) {
                    throw new Error('ŸÑÿß ŸäŸàÿ¨ÿØ ÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™');
                }
                
                if (this.state.proxyErrorCount >= this.state.maxProxyErrors) {
                    console.log('‚ö†Ô∏è ÿ™ÿÆÿ∑Ÿä Proxy ÿ®ÿ≥ÿ®ÿ® ŸÉÿ´ÿ±ÿ© ÿßŸÑÿ£ÿÆÿ∑ÿßÿ°');
                    throw new Error('Proxy ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠');
                }
                
                // ÿ•ŸÑÿ∫ÿßÿ° ÿ£Ÿä ÿ∑ŸÑÿ® ÿ≥ÿßÿ®ŸÇ
                if (this.state.apiController) {
                    this.state.apiController.abort();
                }
                
                this.state.apiController = new AbortController();
                const timeoutId = setTimeout(() => {
                    this.state.apiController.abort();
                }, this.config.API_TIMEOUT);
                
                try {
                    const today = new Date().toISOString().split('T')[0];
                    const url = `${this.config.PROXY_URL}/fixtures?date=${today}`;
                    
                    console.log('üîê ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ Proxy:', url);
                    
                    const response = await fetch(url, {
                        method: 'GET',
                        signal: this.state.apiController.signal,
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    clearTimeout(timeoutId);
                    
                    if (!response.ok) {
                        throw new Error(`Proxy Error: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                    if (data.error) {
                        throw new Error(data.message || 'ÿÆÿ∑ÿ£ ŸÅŸä Proxy');
                    }
                    
                    if (!data.response || !Array.isArray(data.response)) {
                        throw new Error('ÿ®ŸäÿßŸÜÿßÿ™ ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠ÿ© ŸÖŸÜ Proxy');
                    }
                    
                    // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                    const matches = this.transformAPIData(data.response);
                    
                    this.state.proxyErrorCount = 0;
                    console.log(`‚úÖ ÿ™ŸÖ ÿ¨ŸÑÿ® ${matches.length} ŸÖÿ®ÿßÿ±ÿßÿ© ŸÖŸÜ Proxy`);
                    
                    return matches;
                    
                } catch (error) {
                    clearTimeout(timeoutId);
                    
                    if (error.name === 'AbortError') {
                        console.warn('‚è∞ ÿßŸÜÿ™Ÿáÿ™ ŸÖŸáŸÑÿ© Proxy');
                        this.showNotification('ŸÖŸáŸÑÿ© ÿßŸÑÿßÿ™ÿµÿßŸÑ', 'ÿ¨ÿßÿ±Ÿä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜÿ©', 'warning');
                    } else {
                        console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä Proxy:', error.message);
                        this.state.proxyErrorCount++;
                    }
                    
                    throw error;
                }
            }

            // ========== DIRECT API FETCH (ŸÑŸÑÿ∑Ÿàÿßÿ±ÿ¶ ŸÅŸÇÿ∑) ==========
            async fetchDirectAPI() {
                if (!this.state.isOnline) {
                    throw new Error('ŸÑÿß ŸäŸàÿ¨ÿØ ÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™');
                }
                
                if (this.state.apiErrorCount >= this.state.maxApiErrors) {
                    throw new Error('ÿ™ÿ¨ÿßŸàÿ≤ ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ ŸÑÿ£ÿÆÿ∑ÿßÿ° API');
                }
                
                if (!this.config.USE_DIRECT_API || !this.config.DIRECT_API_KEY) {
                    throw new Error('API ÿßŸÑŸÖÿ®ÿßÿ¥ÿ± ÿ∫Ÿäÿ± ŸÖŸÅÿπŸÑ');
                }
                
                this.state.apiController = new AbortController();
                const timeoutId = setTimeout(() => {
                    this.state.apiController.abort();
                }, this.config.API_TIMEOUT);
                
                try {
                    const today = new Date().toISOString().split('T')[0];
                    const url = `https://api-football-v1.p.rapidapi.com/v3/fixtures?date=${today}`;
                    
                    console.log('‚ö†Ô∏è ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ŸÖŸÜ API (ÿ∫Ÿäÿ± ÿ¢ŸÖŸÜ)');
                    
                    const response = await fetch(url, {
                        method: 'GET',
                        signal: this.state.apiController.signal,
                        headers: {
                            'X-RapidAPI-Key': this.config.DIRECT_API_KEY,
                            'X-RapidAPI-Host': 'api-football-v1.p.rapidapi.com'
                        }
                    });
                    
                    clearTimeout(timeoutId);
                    
                    if (!response.ok) {
                        throw new Error(`API Error: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    if (!data.response || !Array.isArray(data.response)) {
                        throw new Error('ÿ®ŸäÿßŸÜÿßÿ™ API ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠ÿ©');
                    }
                    
                    const matches = this.transformAPIData(data.response);
                    
                    this.state.apiErrorCount = 0;
                    console.log(`‚úÖ ÿ™ŸÖ ÿ¨ŸÑÿ® ${matches.length} ŸÖÿ®ÿßÿ±ÿßÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ© ŸÖŸÜ API`);
                    
                    return matches;
                    
                } catch (error) {
                    clearTimeout(timeoutId);
                    
                    if (error.name === 'AbortError') {
                        console.warn('‚è∞ ÿßŸÜÿ™Ÿáÿ™ ŸÖŸáŸÑÿ© API');
                    } else {
                        console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä API ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±:', error.message);
                        this.state.apiErrorCount++;
                    }
                    
                    throw error;
                }
            }

            // ========== DATA TRANSFORMATION ==========
            transformAPIData(apiMatches) {
                const transformed = [];
                const now = new Date();
                
                for (const match of apiMatches) {
                    try {
                        const fixture = match.fixture;
                        const teams = match.teams;
                        const league = match.league;
                        const goals = match.goals;
                        
                        // ÿ™ÿ≠ÿØŸäÿØ ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿ®ÿßÿ±ÿßÿ©
                        let status = 'upcoming';
                        const statusShort = fixture.status.short;
                        
                        if (statusShort === 'FT' || statusShort === 'AET' || statusShort === 'PEN') {
                            status = 'finished';
                        } else if (statusShort === '1H' || statusShort === '2H' || statusShort === 'HT' || 
                                  statusShort === 'ET' || statusShort === 'BT' || statusShort === 'P' || 
                                  statusShort === 'SUSP' || statusShort === 'INT' || statusShort === 'LIVE') {
                            status = 'live';
                        }
                        
                        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ŸáŸÖŸäÿ©
                        let importance = 50;
                        if (league.id === 2) importance = 100; // ÿØŸàÿ±Ÿä ÿßŸÑÿ£ÿ®ÿ∑ÿßŸÑ
                        else if (league.id === 39) importance = 95; // ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿä
                        else if (league.id === 140) importance = 90; // ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ•ÿ≥ÿ®ÿßŸÜŸä
                        else if (league.id === 135) importance = 88; // ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ•Ÿäÿ∑ÿßŸÑŸä
                        else if (league.id === 78) importance = 85; // ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ£ŸÑŸÖÿßŸÜŸä
                        else if (league.country === 'Saudi Arabia') importance = 80; // ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ≥ÿπŸàÿØŸä
                        
                        // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ®ÿßÿ±ÿßÿ©
                        transformed.push({
                            id: fixture.id.toString(),
                            team1: teams.home.name,
                            team2: teams.away.name,
                            league: league.name,
                            country: league.country,
                            date: new Date(fixture.date),
                            status: status,
                            score: goals.home !== null && goals.away !== null ? `${goals.home}-${goals.away}` : null,
                            minute: fixture.status.elapsed || null,
                            venue: fixture.venue?.name || 'ŸÖŸÑÿπÿ® ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ',
                            importance: importance,
                            isLive: status === 'live',
                            isFinished: status === 'finished',
                            isUpcoming: status === 'upcoming',
                            logo: this.getLeagueLogo(league.name),
                            apiData: match
                        });
                        
                    } catch (error) {
                        console.warn('‚ö†Ô∏è ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸàŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ®ÿßÿ±ÿßÿ©:', error);
                    }
                }
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠: ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ŸÅÿßÿ±ÿ∫ÿ©
                if (transformed.length === 0) {
                    console.warn('‚ö†Ô∏è ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ŸÖŸÜ APIÿå ÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©...');
                    transformed.push(...this.generateFallbackMatches(now));
                }
                
                return transformed;
            }

            // ========== FALLBACK DATA GENERATION ==========
            generateFallbackMatches(now) {
                const fallbackMatches = [
                    {
                        team1: 'ÿßŸÑŸáŸÑÿßŸÑ',
                        team2: 'ÿßŸÑŸÜÿµÿ±',
                        league: 'ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ≥ÿπŸàÿØŸä',
                        country: 'ÿßŸÑÿ≥ÿπŸàÿØŸäÿ©',
                        status: 'upcoming',
                        importance: 95
                    },
                    {
                        team1: 'ÿ±ŸäÿßŸÑ ŸÖÿØÿ±ŸäÿØ',
                        team2: 'ÿ®ÿ±ÿ¥ŸÑŸàŸÜÿ©',
                        league: 'ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ•ÿ≥ÿ®ÿßŸÜŸä',
                        country: 'ÿ•ÿ≥ÿ®ÿßŸÜŸäÿß',
                        status: 'upcoming',
                        importance: 98
                    },
                    {
                        team1: 'ŸÖÿßŸÜÿ¥ÿ≥ÿ™ÿ± ÿ≥Ÿäÿ™Ÿä',
                        team2: 'ŸÑŸäŸÅÿ±ÿ®ŸàŸÑ',
                        league: 'ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿä',
                        country: 'ÿ•ŸÜÿ¨ŸÑÿ™ÿ±ÿß',
                        status: 'live',
                        importance: 96
                    }
                ];
                
                return fallbackMatches.map((match, index) => {
                    const hoursOffset = index * 4;
                    const matchTime = new Date(now.getTime() + (hoursOffset * 60 * 60 * 1000));
                    
                    return {
                        id: `fallback_${index}`,
                        team1: match.team1,
                        team2: match.team2,
                        league: match.league,
                        country: match.country,
                        date: matchTime,
                        status: match.status,
                        score: match.status === 'live' ? '1-1' : null,
                        minute: match.status === 'live' ? 65 : null,
                        venue: 'ÿßŸÑŸÖŸÑÿπÿ® ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä',
                        importance: match.importance,
                        isLive: match.status === 'live',
                        isFinished: false,
                        isUpcoming: match.status === 'upcoming',
                        logo: this.getLeagueLogo(match.league)
                    };
                });
            }

            loadEmergencyData() {
                console.log('üÜò ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶...');
                this.state.isEmergencyData = true;
                this.state.dataSource = 'emergency';
                
                const now = new Date();
                const matches = this.generateFallbackMatches(now);
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠: ÿπŸÜÿØ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶ÿå ŸÜÿ∫Ÿäÿ± ÿßŸÑŸÅŸÑÿ™ÿ± ÿ•ŸÑŸâ "all" ÿ™ŸÑŸÇÿßÿ¶ŸäŸãÿß
                this.state.timeFilter = 'all';
                this.processData(matches, 'emergency');
                
                this.showNotification('ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©', 'ÿ¨ÿßÿ±Ÿä ÿπÿ±ÿ∂ ÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿ™ÿ¨ÿ±ÿ®ÿ©', 'warning');
            }

            // ========== SMART DATA PROCESSING ==========
            async processData(matches, source) {
                console.log(`üìä ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ (${source}):`, matches.length);
                
                if (!matches || matches.length === 0) {
                    console.warn('‚ö†Ô∏è ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑŸÖÿπÿßŸÑÿ¨ÿ©');
                    this.loadEmergencyData();
                    return;
                }
                
                this.state.matches = matches;
                this.state.lastUpdate = new Date();
                this.state.updateCount++;
                this.state.dataSource = source;
                
                // ÿßÿ≥ÿ™ÿÆÿ±ÿßÿ¨ ÿßŸÑÿØŸàÿ±Ÿäÿßÿ™ ŸàÿßŸÑÿ®ŸÑÿØÿßŸÜ
                this.state.leagues = new Set(matches.map(m => m.league));
                this.state.countries = new Set(matches.map(m => m.country));
                
                // ÿ≠ŸÅÿ∏ ŸÅŸä ÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑŸÖÿ≠ŸÑŸä
                this.saveToStorage();
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠: ÿßŸÑŸÅŸÑÿ™ÿ±ÿ© ÿßŸÑÿ∞ŸÉŸäÿ© ŸÑŸÖŸÜÿπ ÿßŸÑÿ¥ÿßÿ¥ÿ© ÿßŸÑŸÅÿßÿ±ÿ∫ÿ©
                this.smartFilterData();
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                this.updateUI();
                
                // ÿ•ÿÆŸÅÿßÿ° ÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿÆÿ∑ÿ£
                this.hideError();
                
                // ÿ•ÿ¥ÿπÿßÿ± ÿ≠ÿ≥ÿ® ŸÖÿµÿØÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                this.showDataSourceNotification(source);
            }

            // ========== SMART FILTER SYSTEM - FIXED ==========
            smartFilterData() {
                // ÿ≠ŸÅÿ∏ ÿßŸÑŸÅŸÑÿ™ÿ± ÿßŸÑÿ£ÿµŸÑŸä
                const originalFilter = this.state.timeFilter;
                
                // ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿ®ŸäÿßŸÜÿßÿ™ ÿ∑Ÿàÿßÿ±ÿ¶ÿå ŸÜÿ≥ÿ™ÿÆÿØŸÖ "all" ŸÖÿ®ÿßÿ¥ÿ±ÿ©
                if (this.state.isEmergencyData && originalFilter !== 'all') {
                    this.state.timeFilter = 'all';
                    this.showNotification('ÿπÿ±ÿ∂ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™', 'ÿ®ÿ≥ÿ®ÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶', 'info');
                }
                
                // ŸÖÿ≠ÿßŸàŸÑÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ£ŸàŸÑŸä
                this.applyFilters();
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠: ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ŸÅÿßÿ±ÿ∫ÿ©ÿå ŸÜÿ®ÿ≠ÿ´ ÿπŸÜ ŸÅŸÑÿ™ÿ± ŸÖŸÜÿßÿ≥ÿ®
                if (this.state.filteredMatches.length === 0 && this.state.timeFilter !== 'all') {
                    console.warn(`‚ö†Ô∏è ÿßŸÑŸÅŸÑÿ™ÿ± "${this.state.timeFilter}" Ÿäÿπÿ∑Ÿä 0 ŸÜÿ™Ÿäÿ¨ÿ©`);
                    
                    // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ŸÅŸÑÿ™ÿ± Ÿäÿπÿ∑Ÿä ŸÜÿ™ÿßÿ¶ÿ¨
                    const foundFilter = this.findWorkingFilter();
                    
                    if (foundFilter) {
                        this.state.timeFilter = foundFilter;
                        this.applyFilters();
                        
                        // ÿ•ÿ¥ÿπÿßÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ
                        if (originalFilter !== foundFilter) {
                            this.showNotification(
                                'ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÅŸÑÿ™ÿ± ÿ™ŸÑŸÇÿßÿ¶ŸäŸãÿß',
                                `ŸÖŸÜ "${this.getFilterLabel(originalFilter)}" ÿ•ŸÑŸâ "${this.getFilterLabel(foundFilter)}"`,
                                'warning'
                            );
                        }
                    }
                }
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠ ÿßŸÑŸÜŸáÿßÿ¶Ÿä: ÿ•ÿ∞ÿß ŸÖÿß ÿ≤ÿßŸÑÿ™ ŸÅÿßÿ±ÿ∫ÿ©ÿå ŸÜÿ≥ÿ™ÿÆÿØŸÖ "all"
                if (this.state.filteredMatches.length === 0) {
                    console.warn('‚ö†Ô∏è ÿ¨ŸÖŸäÿπ ÿßŸÑŸÅŸÑÿßÿ™ÿ± ÿ™ÿπÿ∑Ÿä 0 ŸÜÿ™Ÿäÿ¨ÿ©ÿå ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ "all"');
                    this.state.timeFilter = 'all';
                    this.applyFilters();
                }
            }

            findWorkingFilter() {
                const filterOrder = ['week', 'tomorrow', 'today', 'all'];
                
                for (const filter of filterOrder) {
                    if (filter === this.state.timeFilter) continue;
                    
                    // ÿ™ÿ¨ÿ±ÿ®ÿ© ÿßŸÑŸÅŸÑÿ™ÿ±
                    const tempFilter = this.state.timeFilter;
                    this.state.timeFilter = filter;
                    this.applyFilters();
                    
                    if (this.state.filteredMatches.length > 0) {
                        console.log(`‚úÖ ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÅŸÑÿ™ÿ± ÿπÿßŸÖŸÑ: ${filter}`);
                        return filter;
                    }
                    
                    // ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ
                    this.state.timeFilter = tempFilter;
                }
                
                return 'all'; // ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä
            }

            applyFilters() {
                let filtered = [...this.state.matches];
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠: ŸÅŸÑÿ™ÿ± "all" ŸÑÿß Ÿäÿ∑ÿ®ŸÇ ÿ£Ÿä ÿ™ÿµŸÅŸäÿ© ÿ≤ŸÖŸÜŸäÿ©
                if (this.state.timeFilter !== 'all') {
                    const now = new Date();
                    const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    
                    switch (this.state.timeFilter) {
                        case 'today':
                            const todayEnd = new Date(todayStart.getTime() + 24 * 60 * 60 * 1000);
                            filtered = filtered.filter(m => 
                                new Date(m.date) >= todayStart && 
                                new Date(m.date) < todayEnd
                            );
                            break;
                        case 'tomorrow':
                            const tomorrowStart = new Date(todayStart.getTime() + 24 * 60 * 60 * 1000);
                            const tomorrowEnd = new Date(tomorrowStart.getTime() + 24 * 60 * 60 * 1000);
                            filtered = filtered.filter(m => 
                                new Date(m.date) >= tomorrowStart && 
                                new Date(m.date) < tomorrowEnd
                            );
                            break;
                        case 'week':
                            const weekEnd = new Date(todayStart.getTime() + 7 * 24 * 60 * 60 * 1000);
                            filtered = filtered.filter(m => 
                                new Date(m.date) >= todayStart && 
                                new Date(m.date) < weekEnd
                            );
                            break;
                    }
                }
                
                // ÿ™ÿµŸÅŸäÿ© ÿßŸÑÿØŸàÿ±Ÿä
                if (this.state.leagueFilter !== 'all') {
                    filtered = filtered.filter(m => m.league === this.state.leagueFilter);
                }
                
                // ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                filtered.sort((a, b) => {
                    // ŸÖÿ®ÿßÿ¥ÿ± ÿ£ŸàŸÑÿßŸã
                    if (a.isLive && !b.isLive) return -1;
                    if (!a.isLive && b.isLive) return 1;
                    
                    // ÿ´ŸÖ ŸÇÿßÿØŸÖÿ©
                    if (a.isUpcoming && !b.isUpcoming) return -1;
                    if (!a.isUpcoming && b.isUpcoming) return 1;
                    
                    // ÿ´ŸÖ ÿ≠ÿ≥ÿ® ÿßŸÑÿ£ŸáŸÖŸäÿ©
                    if (a.importance !== b.importance) return b.importance - a.importance;
                    
                    // ÿ´ŸÖ ÿ≠ÿ≥ÿ® ÿßŸÑÿ™ÿßÿ±ŸäÿÆ
                    return new Date(a.date) - new Date(b.date);
                });
                
                this.state.filteredMatches = filtered;
            }

            // ========== UI UPDATES ==========
            updateUI() {
                this.updateStats();
                this.renderMatches();
                this.updateFilters();
            }

            updateStats() {
                const liveCount = this.state.matches.filter(m => m.isLive).length;
                const totalFiltered = this.state.filteredMatches.length;
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠: ÿπÿ±ÿ∂ 0 ŸÅŸÇÿ∑ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ÿ®ŸäÿßŸÜÿßÿ™
                document.getElementById('totalMatches').textContent = totalFiltered || 0;
                document.getElementById('liveMatches').textContent = liveCount || 0;
                document.getElementById('leaguesCount').textContent = this.state.leagues.size || 0;
                document.getElementById('liveMatchesCount').textContent = liveCount || 0;
                
                // ÿ™ÿ≠ÿØŸäÿ´ ŸàŸÇÿ™ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´
                if (this.state.lastUpdate) {
                    const diff = Math.floor((Date.now() - this.state.lastUpdate) / 60000);
                    document.getElementById('updateTime').textContent = 
                        diff < 1 ? 'ÿßŸÑÿ¢ŸÜ' : 
                        diff < 60 ? `ŸÇÿ®ŸÑ ${diff} ÿØŸÇŸäŸÇÿ©` :
                        `ŸÇÿ®ŸÑ ${Math.floor(diff/60)} ÿ≥ÿßÿπÿ©`;
                }
            }

            renderMatches() {
                const container = document.getElementById('matchesContainer');
                const emptyState = document.getElementById('emptyState');
                const errorState = document.getElementById('errorState');
                
                // üîß ÿßŸÑÿ•ÿµŸÑÿßÿ≠: ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ÿ∞ŸÉŸäÿ© ÿπŸÜÿØ ÿπÿØŸÖ Ÿàÿ¨ŸàÿØ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™
                if (this.state.filteredMatches.length === 0) {
                    container.innerHTML = '';
                    emptyState.style.display = 'block';
                    errorState.style.display = 'none';
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ŸÜÿµ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©
                    const emptyText = document.querySelector('#emptyState h3');
                    if (emptyText) {
                        if (this.state.matches.length === 0) {
                            emptyText.textContent = 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ŸÖÿ™ÿßÿ≠ÿ©';
                        } else {
                            emptyText.textContent = `ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ŸÅŸä "${this.getFilterLabel(this.state.timeFilter)}"`;
                        }
                    }
                    return;
                }
                
                emptyState.style.display = 'none';
                errorState.style.display = 'none';
                
                // ÿπÿ±ÿ∂ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™
                container.innerHTML = this.state.filteredMatches.map(match => `
                    <div class="match-card ${match.status} ${match.importance > 85 ? 'important' : ''}">
                        <div class="match-header">
                            <div class="league-info">
                                <div class="league-logo">${match.logo || '‚öΩ'}</div>
                                <div>
                                    <div style="font-weight: 700; font-size: 0.9rem;">${match.league}</div>
                                    <div style="font-size: 0.8rem; color: var(--gray);">
                                        <i class="fas fa-globe"></i> ${match.country}
                                    </div>
                                </div>
                            </div>
                            <div class="match-status ${match.isLive ? 'status-live' : match.isUpcoming ? 'status-upcoming' : 'status-finished'}">
                                ${match.isLive ? 'ŸÖÿ®ÿßÿ¥ÿ± üî¥' : match.isUpcoming ? 'ŸÇÿßÿØŸÖÿ©' : 'ŸÖŸÜÿ™ŸáŸäÿ©'}
                            </div>
                        </div>
                        
                        <div class="teams-section">
                            <div class="team">
                                <div class="team-logo">${match.team1.charAt(0)}</div>
                                <div class="team-name">${match.team1}</div>
                            </div>
                            
                            <div class="vs-section">
                                <div class="score">${match.score || 'VS'}</div>
                                <div class="vs">${this.formatMatchTime(match)}</div>
                            </div>
                            
                            <div class="team">
                                <div class="team-logo">${match.team2.charAt(0)}</div>
                                <div class="team-name">${match.team2}</div>
                            </div>
                        </div>
                        
                        <div class="match-details">
                            <div class="detail-item">
                                <i class="fas fa-calendar-alt"></i>
                                <span>${this.formatDate(match.date)}</span>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-clock"></i>
                                <span>${this.formatTime(match.date)}</span>
                            </div>
                            <div class="detail-item" style="grid-column: span 2;">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${match.venue}</span>
                            </div>
                            ${match.importance > 90 ? `
                                <div class="detail-item" style="grid-column: span 2; justify-content: center; background: rgba(255, 193, 7, 0.1); border-radius: 8px; padding: 8px;">
                                    <i class="fas fa-crown" style="color: var(--warning);"></i>
                                    <span style="color: var(--warning); font-weight: 700;">ŸÖÿ®ÿßÿ±ÿßÿ© ÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</span>
                                </div>
                            ` : ''}
                            ${this.state.dataSource === 'proxy' ? `
                                <div class="detail-item" style="grid-column: span 2; justify-content: center; background: rgba(0, 200, 83, 0.1); border-radius: 8px; padding: 8px;">
                                    <i class="fas fa-shield-alt" style="color: var(--primary);"></i>
                                    <span style="color: var(--primary); font-weight: 700;">ÿ®ŸäÿßŸÜÿßÿ™ ÿ¢ŸÖŸÜÿ©</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `).join('');
            }

            // ========== HELPER FUNCTIONS ==========
            getLeagueLogo(leagueName) {
                const logos = {
                    'Premier League': 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',
                    'La Liga': 'üá™üá∏',
                    'Serie A': 'üáÆüáπ',
                    'Bundesliga': 'üá©üá™',
                    'Ligue 1': 'üá´üá∑',
                    'Saudi Professional League': 'üá∏üá¶',
                    'UEFA Champions League': 'üèÜ',
                    'UEFA Europa League': 'üåü',
                    'Copa del Rey': 'ü•á',
                    'FA Cup': 'üèÜ',
                    'ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ≥ÿπŸàÿØŸä': 'üá∏üá¶',
                    'ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿä': 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',
                    'ÿßŸÑÿØŸàÿ±Ÿä ÿßŸÑÿ•ÿ≥ÿ®ÿßŸÜŸä': 'üá™üá∏'
                };
                return logos[leagueName] || '‚öΩ';
            }

            formatMatchTime(match) {
                const matchTime = new Date(match.date);
                const now = new Date();
                
                if (match.isLive) {
                    return `ÿßŸÑÿØŸÇŸäŸÇÿ© ${match.minute || '0'}`;
                }
                
                if (match.isUpcoming) {
                    const diff = matchTime - now;
                    const hours = Math.floor(diff / (1000 * 60 * 60));
                    
                    if (hours < 24 && hours > 0) {
                        return `ÿ®ÿπÿØ ${hours} ÿ≥ÿßÿπÿ©`;
                    } else if (hours <= 0) {
                        return 'ŸÇÿ±Ÿäÿ®Ÿãÿß';
                    }
                    
                    return matchTime.toLocaleTimeString('ar-SA', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                }
                
                return 'ÿßŸÜÿ™Ÿáÿ™';
            }

            formatDate(date) {
                return new Date(date).toLocaleDateString('ar-SA', {
                    weekday: 'long',
                    day: 'numeric',
                    month: 'long'
                });
            }

            formatTime(date) {
                return new Date(date).toLocaleTimeString('ar-SA', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }

            getFilterLabel(filter) {
                const labels = {
                    'today': 'ÿßŸÑŸäŸàŸÖ',
                    'tomorrow': 'ÿ∫ÿØŸãÿß',
                    'week': 'Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ',
                    'all': 'ÿßŸÑŸÉŸÑ'
                };
                return labels[filter] || filter;
            }

            // ========== FILTER CONTROLS ==========
            updateFilters() {
                this.updateTimeFilter();
                this.updateLeagueFilter();
            }

            updateTimeFilter() {
                const filters = [
                    { id: 'today', label: 'ÿßŸÑŸäŸàŸÖ' },
                    { id: 'tomorrow', label: 'ÿ∫ÿØŸãÿß' },
                    { id: 'week', label: 'Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ' },
                    { id: 'all', label: 'ÿßŸÑŸÉŸÑ' }
                ];
                
                const container = document.getElementById('timeFilter');
                container.innerHTML = filters.map(filter => `
                    <button class="time-btn ${this.state.timeFilter === filter.id ? 'active' : ''}" 
                            onclick="FootballApp.setTimeFilter('${filter.id}')">
                        ${filter.label}
                    </button>
                `).join('');
            }

            updateLeagueFilter() {
                const leagues = ['all', ...Array.from(this.state.leagues)];
                
                const container = document.getElementById('leagueFilter');
                container.innerHTML = leagues.slice(0, 8).map(league => `
                    <button class="league-btn ${this.state.leagueFilter === league ? 'active' : ''}" 
                            onclick="FootballApp.setLeagueFilter('${league}')">
                        ${league === 'all' ? 'ÿ¨ŸÖŸäÿπ ÿßŸÑÿØŸàÿ±Ÿäÿßÿ™' : league}
                    </button>
                `).join('');
            }

            // ========== STORAGE ==========
            saveToStorage() {
                try {
                    const data = {
                        matches: this.state.matches,
                        lastUpdate: this.state.lastUpdate,
                        timeFilter: this.state.timeFilter,
                        leagueFilter: this.state.leagueFilter,
                        dataSource: this.state.dataSource,
                        version: this.config.VERSION
                    };
                    
                    localStorage.setItem('footscore_pro_data', JSON.stringify(data));
                } catch (e) {
                    console.warn('‚ö†Ô∏è ÿ™ÿπÿ∞ÿ± ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
                }
            }

            loadCachedData() {
                try {
                    const data = localStorage.getItem('footscore_pro_data');
                    if (!data) return null;
                    
                    const parsed = JSON.parse(data);
                    
                    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ•ÿµÿØÿßÿ±
                    if (parsed.version !== this.config.VERSION) return null;
                    
                    // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿ©
                    if (!parsed.lastUpdate) return null;
                    
                    const expiryTime = new Date(parsed.lastUpdate).getTime() + this.config.CACHE_DURATION;
                    if (Date.now() > expiryTime) return null;
                    
                    // ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑŸÅŸÑÿßÿ™ÿ±
                    if (parsed.timeFilter) this.state.timeFilter = parsed.timeFilter;
                    if (parsed.leagueFilter) this.state.leagueFilter = parsed.leagueFilter;
                    if (parsed.dataSource) this.state.dataSource = parsed.dataSource;
                    
                    // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ™Ÿàÿßÿ±ŸäÿÆ
                    const matches = parsed.matches.map(match => ({
                        ...match,
                        date: new Date(match.date)
                    }));
                    
                    console.log(`üìÇ ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ${matches.length} ŸÖÿ®ÿßÿ±ÿßÿ© ŸÖŸÜ ÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑŸÖÿ≠ŸÑŸä`);
                    return matches;
                    
                } catch (e) {
                    console.warn('‚ö†Ô∏è ÿ™ÿπÿ∞ÿ± ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜÿ©');
                    return null;
                }
            }

            // ========== EVENT HANDLERS ==========
            setupEventListeners() {
                window.addEventListener('online', () => {
                    this.state.isOnline = true;
                    this.showConnectionStatus('ÿ™ŸÖ ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿßÿ™ÿµÿßŸÑ', 'success');
                    this.fetchDataWithFallback();
                });
                
                window.addEventListener('offline', () => {
                    this.state.isOnline = false;
                    this.showConnectionStatus('ŸÑÿß ŸäŸàÿ¨ÿØ ÿßÿ™ÿµÿßŸÑ', 'error');
                    this.showNotification('ÿßŸÑÿπŸÖŸÑ ÿ®ÿØŸàŸÜ ÿßÿ™ÿµÿßŸÑ', 'ÿ¨ÿßÿ±Ÿä ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜÿ©', 'warning');
                });
                
                document.addEventListener('visibilitychange', () => {
                    if (!document.hidden && this.state.isOnline && !this.state.isLoading) {
                        this.fetchDataWithFallback();
                    }
                });
            }

            // ========== PUBLIC METHODS ==========
            setTimeFilter(filter) {
                const oldFilter = this.state.timeFilter;
                this.state.timeFilter = filter;
                
                // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶ ÿ•ÿ∞ÿß ÿ™ÿ∫Ÿäÿ± ÿßŸÑŸÅŸÑÿ™ÿ± ŸäÿØŸàŸäŸãÿß
                if (this.state.isEmergencyData) {
                    this.state.isEmergencyData = false;
                }
                
                this.smartFilterData();
                this.updateUI();
                
                if (oldFilter !== filter) {
                    this.showNotification(
                        'ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÅŸÑÿ™ÿ±',
                        `ŸÖŸÜ "${this.getFilterLabel(oldFilter)}" ÿ•ŸÑŸâ "${this.getFilterLabel(filter)}"`,
                        'info'
                    );
                }
            }

            setLeagueFilter(filter) {
                this.state.leagueFilter = filter;
                this.applyFilters();
                this.updateUI();
            }

            refreshMatches() {
                this.showNotification('ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ÿØŸäÿ´', 'ÿ¨ÿßÿ±Ÿä ÿ¨ŸÑÿ® ÿ£ÿ≠ÿØÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...', 'info');
                this.fetchDataWithFallback();
            }

            showLiveMatches() {
                const liveMatches = this.state.matches.filter(m => m.isLive);
                if (liveMatches.length > 0) {
                    this.state.filteredMatches = liveMatches;
                    this.updateUI();
                    this.showNotification('ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©', `ÿπÿ±ÿ∂ ${liveMatches.length} ŸÖÿ®ÿßÿ±ÿßÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ©`, 'info');
                } else {
                    this.showNotification('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™', 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ≠ÿßŸÑŸäÿßŸã', 'warning');
                }
            }

            scrollToTop() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            // ========== UTILITIES ==========
            hideLoading() {
                document.getElementById('skeletonLoading').style.display = 'none';
            }

            hideError() {
                document.getElementById('errorState').style.display = 'none';
            }

            // ========== AUTO UPDATES ==========
            startAutoUpdates() {
                clearInterval(this.state.updateTimer);
                
                const interval = this.state.isOnline ? 
                    this.config.UPDATE_INTERVAL : 
                    this.config.OFFLINE_UPDATE_INTERVAL;
                
                this.state.updateTimer = setInterval(() => {
                    if (this.state.isOnline && !this.state.isLoading) {
                        this.fetchDataWithFallback();
                    }
                }, interval);
            }

            // ========== NOTIFICATIONS ==========
            showDataSourceNotification(source) {
                const messages = {
                    'proxy': ['ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´', 'ÿ®ŸäÿßŸÜÿßÿ™ ÿ¢ŸÖŸÜÿ© ŸÖŸÜ Proxy', 'success'],
                    'direct': ['ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´', 'ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ŸÖŸÜ API', 'warning'],
                    'cache': ['ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿÆÿ≤ŸÜÿ©', 'ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´: ' + this.formatRelativeTime(this.state.lastUpdate), 'info'],
                    'emergency': ['ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©', 'ÿ¨ÿßÿ±Ÿä ÿπÿ±ÿ∂ ÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿ™ÿ¨ÿ±ÿ®ÿ©', 'warning']
                };
                
                if (messages[source]) {
                    this.showNotification(...messages[source]);
                }
            }

            formatRelativeTime(date) {
                const diff = Math.floor((Date.now() - date) / 60000);
                if (diff < 1) return 'ÿßŸÑÿ¢ŸÜ';
                if (diff < 60) return `ŸÇÿ®ŸÑ ${diff} ÿØŸÇŸäŸÇÿ©`;
                if (diff < 1440) return `ŸÇÿ®ŸÑ ${Math.floor(diff/60)} ÿ≥ÿßÿπÿ©`;
                return `ŸÇÿ®ŸÑ ${Math.floor(diff/1440)} ŸäŸàŸÖ`;
            }

            showNotification(title, message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.style.background = type === 'error' ? 'var(--danger)' : 
                                               type === 'warning' ? 'var(--warning)' : 
                                               type === 'success' ? 'var(--primary)' : 
                                               'var(--secondary)';
                
                notification.innerHTML = `
                    <div>
                        <strong>${title}</strong>
                        <div style="font-size: 0.9rem; margin-top: 5px;">${message}</div>
                    </div>
                    <button onclick="this.parentElement.remove()" style="background: none; border: none; color: inherit; cursor: pointer;">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 5000);
            }

            showConnectionStatus(message, type = 'info') {
                const status = document.getElementById('connectionStatus');
                status.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'wifi' : 'wifi-slash'}"></i>
                    <span>${message}</span>
                `;
                
                status.className = `connection-status ${type} show`;
                
                setTimeout(() => {
                    status.classList.remove('show');
                }, 3000);
            }
        }

        // ========== INITIALIZE ==========
        let FootballApp;
        document.addEventListener('DOMContentLoaded', () => {
            FootballApp = new FootballApp();
            window.FootballApp = FootballApp;
        });
    </script>
</body>
</html>
